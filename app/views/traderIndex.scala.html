@import controllers.actions.LoginState
@import models.master.{Organization, Zone}
@import views.html.base.common

@(totalFiat: Int, zone: Zone, organization: Organization, failures: Seq[constants.Response.Failure] = Seq(), warnings: Seq[constants.Response.Warning] = Seq(), successes: Seq[constants.Response.Success] = Seq(), infos: Seq[constants.Response.Info] = Seq())(implicit requestHeader: RequestHeader, messagesProvider: MessagesProvider, flash: Flash, configuration: play.api.Configuration, loginState: LoginState = null)

@common(Messages(constants.Form.HOME), failures, warnings, successes, infos)(Html(""))(center)(Html(""))

@center = {
    <div>
        <div id="commonHome"></div>
    </div>
    <ul cmuk-accordion="multiple: true" class="flexContainer">
        <li>
            <a class="cmuk-accordion-title" href="#">@Messages(constants.Form.ZONE):</a>
            <div class="cmuk-accordion-content">
                <div id="organization">
                </div>
              </div>
        </li>
        <li>
            <a class="cmuk-accordion-title" href="#">@Messages(constants.Form.ORGANIZATION):</a>
            <div class="cmuk-accordion-content">
                <div id="zone">
                </div>
            </div>
        </li>
    </ul>
     <ul cmuk-accordion class="flexContainer">
         <li>
             <a class="cmuk-accordion-title" href="#" onclick="fetchOrShowHide('assetList', jsRoutes.controllers.ComponentViewController.assetList(), this)">@Messages(constants.Form.ASSETS_OWNED)</a>
                <div class="cmuk-accordion-buttons">
                    @loginState.acl match {
                        case Some(acl) => {
                            @if(acl.issueAsset) {
                                <button onclick="getForm(jsRoutes.controllers.IssueAssetController.issueAssetDetailForm())">@Messages(constants.Form.ISSUE_ASSET_REQUEST.legend)</button>
                            }
                        }
                        case _ => {}
                    }
                </div>
                <div class="cmuk-accordion-content">
                    <div id="assetList" class="flexContainer"></div>
                        <script type="text/javascript">
                                var assetCometMessage = function (event) {
                                    console.log(event.toString());
                                    componentResource('assetList', jsRoutes.controllers.ComponentViewController.assetList());
                                }
                        </script>
                </div>
          </li>
    </ul>
    <ul cmuk-accordion class="flexContainer">
        <li>
            <a class="cmuk-accordion-title" href="#" onclick="fetchOrShowHide('fiatList', jsRoutes.controllers.ComponentViewController.fiatList(), this)">@Messages(constants.Form.FIATS_OWNED)
                : <span id="totalFiat">@totalFiat</span></a>
            <div class="cmuk-accordion-buttons">
                @loginState.acl match {
                    case Some(acl) => {
                        @if(acl.issueFiat) {
                            <button type="button" class="cmuk-button cmuk-button-primary" onclick="getForm(jsRoutes.controllers.IssueFiatController.issueFiatRequestForm())">@Messages(constants.Form.ISSUE_FIAT_REQUEST.legend)</button>
                        }
                        @if(acl.redeemFiat) {
                            <button type="button" class="cmuk-button cmuk-button-primary" onclick="getForm(jsRoutes.controllers.RedeemFiatController.redeemFiatForm('@loginState.username'))">@Messages(constants.Form.REDEEM_FIAT.legend)</button>
                        }
                    }
                    case _ => {}
                }
            </div>
            <div class="cmuk-accordion-content">
                <div id="fiatList" class="flexContainer"></div>
                <script type="text/javascript">
                        var fiatCometMessage = function (event) {
                            console.log(event.toString());
                            $('#totalFiat').html(event);
                            componentResource('fiatList', jsRoutes.controllers.ComponentViewController.fiatList());
                        }
                </script>
            </div>
        </li>
    </ul>
    <ul class="flexContainer" cmuk-accordion>
        <li class="cmuk-open">
            <a class="cmuk-accordion-title" href="#">@Messages(constants.Form.ON_GOING_NEGOTIATIONS)</a>
            <div class="cmuk-accordion-content">
                <ul cmuk-accordion>
                    <li>
                        <a class="cmuk-accordion-title" href="#" onclick="fetchOrShowHide('buyNegotiationList', jsRoutes.controllers.ComponentViewController.buyNegotiationList(), this)">@Messages(constants.Form.BUY)</a>
                        <div class="cmuk-accordion-content">
                            <div id="buyNegotiationList" class="flexContainer"></div>
                        </div>
                    </li>
                </ul>
                <ul  cmuk-accordion>
                    <li>
                        <a class="cmuk-accordion-title" href="#" onclick="fetchOrShowHide('sellNegotiationList', jsRoutes.controllers.ComponentViewController.sellNegotiationList(), this)">@Messages(constants.Form.SELL)</a>
                        <div class="cmuk-accordion-content">
                            <div id="sellNegotiationList" class="flexContainer"></div>
                        </div>
                    </li>
                </ul>
            </div>
             <script type="text/javascript">
                var negotiationCometMessage = function (event) {
                    console.log(event.toString());
                    componentResource('buyNegotiationList', jsRoutes.controllers.ComponentViewController.buyNegotiationList());
                    componentResource('sellNegotiationList', jsRoutes.controllers.ComponentViewController.sellNegotiationList());
                }
            </script>
        </li>
    </ul>
    <ul class="flexContainer" cmuk-accordion>
        <li>
            <a class="cmuk-accordion-title" href="#" onclick="fetchOrShowHide('orderList', jsRoutes.controllers.ComponentViewController.orderList(), this)">@Messages(constants.Form.ON_GOING_ORDERS)</a>
            <div class="cmuk-accordion-content">
                <div id="orderList" class="flexContainer"></div>
                <script type="text/javascript">
                    var orderCometMessage = function (event) {
                        console.log(event.toString());
                        componentResource('orderList', jsRoutes.controllers.ComponentViewController.orderList());
                    }
                </script>
            </div>
        </li>
    </ul>
    <ul class="flexContainer" cmuk-accordion>
        <li class="cmuk-open">
            <a class="cmuk-accordion-title" href="#">@Messages(constants.Form.SUBMIT_FEEDBACK)</a>
            <div class="cmuk-accordion-content">
                <ul cmuk-accordion>
                    <li>
                        <a class="cmuk-accordion-title" href="#" onclick="fetchOrShowHide('setBuyerFeedbackList', jsRoutes.controllers.SetBuyerFeedbackController.buyerFeedbackList(), this)">@Messages(constants.Form.BUY_ORDER_FEEDBACKS)</a>
                        <div class="cmuk-accordion-content">
                            <div id="setBuyerFeedbackList" class="flexContainer"></div>
                        </div>
                    </li>
                </ul>
                <ul cmuk-accordion>
                    <li>
                        <a class="cmuk-accordion-title" href="#" onclick="fetchOrShowHide('setSellerFeedbackList', jsRoutes.controllers.SetSellerFeedbackController.sellerFeedbackList(), this)">@Messages(constants.Form.SELL_ORDER_FEEDBACKS)</a>
                        <div class="cmuk-accordion-content">
                            <div id="setSellerFeedbackList" class="flexContainer"></div>
                        </div>
                    </li>
                </ul>
            </div>
        </li>
    </ul>
    <script>
            componentResource('commonHome', jsRoutes.controllers.ComponentViewController.commonHome());
            componentResource('zone', jsRoutes.controllers.ComponentViewController.zoneDetails());
            componentResource('organization', jsRoutes.controllers.ComponentViewController.organizationDetails());
    </script>
    <iframe class="hidden" src="@routes.ComponentViewController.assetComet"></iframe>
    <iframe class="hidden" src="@routes.ComponentViewController.fiatComet"></iframe>
    <iframe class="hidden" src="@routes.ComponentViewController.negotiationComet"></iframe>
    <iframe class="hidden" src="@routes.ComponentViewController.orderComet"></iframe>
}