@import controllers.actions.LoginState
@import views.html.base._
@import models.master.Negotiation
@import models.master.Asset
@import models.master.Trader

@(incompleteNegotiationList: Seq[Negotiation], counterPartyTraders: Seq[Trader])(implicit requestHeader: RequestHeader, messagesProvider: MessagesProvider, loginState: LoginState = null)

@incompleteNegotiationList.map { incompleteNegotiation =>
    @commonVerticalInfoBox() {
        @defining(counterPartyTraders.find(_.id == incompleteNegotiation.buyerTraderID)) { counterPartyTrader: Option[Trader] =>
            @counterPartyTrader match {
                case Some(trader) => {
                    @commonVerticalTextInfo(constants.View.TRADER_NAME, trader.name)
                }
                case None => {
                    @commonVerticalTextInfo(constants.View.TRADER_ID, incompleteNegotiation.buyerTraderID)
                }
            }
        }
        @commonVerticalTextInfo(constants.View.ASSET_DESCRIPTION, incompleteNegotiation.assetDescription)
        @commonVerticalIntInfo(constants.View.PRICE, incompleteNegotiation.price)
        @commonVerticalTextInfo(constants.View.QUANTITY, Seq(incompleteNegotiation.quantity.toString(), incompleteNegotiation.quantityUnit).mkString(" "))
        @commonVerticalTextInfo(constants.View.STATUS, incompleteNegotiation.status)
        <div class="listItemChild">
            <p class="listItemChildTitle">
            @Messages(constants.View.ACTION)
            </p>
            <p class="listItemChildValue">
            @commonFormButton(constants.Form.NEGOTIATION_PAYMENT_TERMS, 'parameters -> s"'${incompleteNegotiation.id}'")
            </p>
        </div>
    }
}
