@import controllers.actions.LoginState
@import views.html.base._
@import models.master.Negotiation
@import models.master.Asset
@import models.master.Trader

@(buyNegotiationList: Seq[Negotiation], assets: Seq[Asset], counterPartyTraders: Seq[Trader])(implicit requestHeader: RequestHeader, messagesProvider: MessagesProvider, loginState: LoginState = null)

@buyNegotiationList.map { buyNegotiation =>
    <li class="commonList">
        @defining(counterPartyTraders.filter(_.id == buyNegotiation.buyerTraderID).headOption) { counterPartyTrader: Option[Trader] =>
            @counterPartyTrader match {
                case Some(trader) => {
                    @commonVerticalTextInfo(constants.View.TRADER_NAME, trader.name)
                }
                case None => {
                    @commonVerticalTextInfo(constants.View.TRADER_ID, buyNegotiation.buyerTraderID)
                }
            }
        }
        @defining(assets.filter(_.id == buyNegotiation.assetID).headOption) { rejectedNegotiationAsset: Option[Asset] =>
            @rejectedNegotiationAsset match {
                case Some(asset) => {
                    @commonVerticalTextInfo(constants.View.ASSET_DESCRIPTION, asset.description)
                }
                case None => {
                    @commonVerticalTextInfo(constants.View.ASSET_ID, buyNegotiation.assetID)
                }
            }
        }
        @commonVerticalIntInfo(constants.View.PRICE, buyNegotiation.price)
        @commonVerticalTextInfo(constants.View.QUANTITY, Seq(buyNegotiation.quantity.toString(), buyNegotiation.quantityUnit).mkString(" "))
        @commonVerticalTextInfo(constants.View.STATUS, buyNegotiation.status)
        <div class="listItemChild">
            <p class="listItemChildTitle">
            @Messages(constants.View.ACTION)
            </p>
            <p class="listItemChildValue">
                <button class="cmuk-button cmuk-button-primary cmuk-button-small">
                    <a class="cmuk-link secondaryFont" href="@routes.ViewController.tradeRoom(buyNegotiation.id)">@Messages(constants.View.GO_TO_TRADE_ROOM)</a>
                </button>
            </p>
    </div>

}
