@import controllers.actions.LoginState
@import views.html.base._
@import helper._
@import views.companion.master.DocumentList

@(documentsListForm: Form[DocumentList.Data] = DocumentList.form, id: String)(implicit requestHeader: RequestHeader, messagesProvider: MessagesProvider, flash: Flash, loginState: LoginState = null)
<script src="@routes.Assets.versioned("javascripts/documentList.js")" type="text/javascript"></script>
@commonForm(constants.Form.NEGOTIATION_DOCUMENT_LIST, documentsListForm) {
    <div class="infoBlock">
        <div class="infoBlockItem">
        @commonInputText(documentsListForm, constants.FormField.ID, 'value -> id, 'containerDivClass -> "hidden", 'readonly -> true)
        @commonCheckbox(documentsListForm, constants.FormField.BILL_OF_LADING, 'onclick -> "onDocumentSelect(this)")
        @commonCheckbox(documentsListForm, constants.FormField.COO, 'onclick -> "onDocumentSelect(this)")
        @commonCheckbox(documentsListForm, constants.FormField.COA, 'onclick -> "onDocumentSelect(this)")
        @commonCheckbox(documentsListForm, constants.FormField.BILL_OF_EXCHANGE, 'onclick -> "onDocumentSelect(this)")
        @commonCheckbox(documentsListForm, constants.FormField.INVOICE, 'onclick -> "onDocumentSelect(this)")
        @repeatWithIndex(documentsListForm(constants.FormField.DOCUMENT_LIST.name), min = documentsListForm(constants.FormField.DOCUMENT_LIST.name).indexes.length + 1) { (documentField, i) =>
            @defining(Option(documentField)) { implicit sequentialFormField =>
                @if(if(documentField.value.isDefined) constants.File.NEGOTIATION_DOCUMENTS.contains(documentField.value.get) || constants.File.ASSET_DOCUMENTS.contains(documentField.value.get) else false) {
                    <div id='@Seq(constants.FormField.DOCUMENT_LIST.name, i).mkString("_")' class="hidden">
                    @commonInputText(documentsListForm, constants.FormField.DOCUMENT_TYPE)
                    </div>
                    <script>initializeCheckBox('@documentField.value.get')</script>
                } else {
                    <div id='@Seq(constants.FormField.DOCUMENT_LIST.name, i).mkString("_")' class="updateDocumentField">
                        @commonInputText(documentsListForm, constants.FormField.DOCUMENT_TYPE)
                        @commonJavascriptButton(constants.View.DELETE, JavaScript("""deleteElementBySource(this)"""), 'class -> "cmuk-button-link")
                    </div>
                }
            }
        }
        </div>
        <div class="infoBlockItem">
            <div class="infoBlockItemRight">
        @commonJavascriptButton(constants.View.ADD, JavaScript("onDocumentListIncomplete(this)"))
        @commonCheckbox(documentsListForm, constants.FormField.DOCUMENT_LIST_COMPLETED, 'containerDivClass -> "hidden", 'id -> "negotiationDocumentListCompleted")
        @commonSelect(documentsListForm, constants.FormField.PHYSICAL_DOCUMENTS_HANDLED_VIA)
        @commonModalButton(constants.View.BACK, constants.Form.NEGOTIATION_PAYMENT_TERMS.get, 'parameters -> s"'${id}'")
        </div>
        </div>
    </div>
}

