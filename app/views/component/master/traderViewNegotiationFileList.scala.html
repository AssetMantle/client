@import controllers.actions.LoginState
@import views.html.base._
@import models.masterTransaction.NegotiationFile

@import models.masterTransaction.AssetFile

@import models.master.Negotiation
@(id:String,traderID:String,negotiation:Negotiation, assetFiles:Seq[AssetFile],negotiationFiles: Seq[NegotiationFile], envelopeStatus:Option[String])(implicit requestHeader: RequestHeader, messagesProvider: MessagesProvider, loginState: LoginState = null)
<script src="@routes.Assets.versioned("javascripts/switchTab.js")" type="text/javascript"></script>

@Messages(constants.View.ASSET_DOCUMENTS):
@assetFiles.filter(assetFile=> negotiation.documentList.assetDocuments.contains(assetFile.documentType)).map{assetFile=>
    <div>
        <a onclick="switchTab('@constants.View.VIEW_DOCUMENTS','1', jsRoutes.controllers.ComponentViewController.traderViewNegotiationFile('@id', '@assetFile.documentType'))">@Messages(assetFile.documentType)</a>
        @assetFile.documentType match{
            case constants.File.OBL=> {<td class="seenIcon"><img src="@routes.Assets.versioned("./images/icons/seenIcon.svg")" onclick="getForm(jsRoutes.controllers.NegotiationController.negotiationDocumentContent('@id','@assetFile.documentType'))")></td>}
            case _=>{}
        }
    </div>
}

@Messages(constants.View.NEGOTIATION_DOCUMENTS):
@negotiationFiles.filter(negotiationFile=> negotiation.documentList.negotiationDocuments.contains(negotiationFile.documentType)|| negotiationFile.documentType == constants.File.CONTRACT).map{negotiationFile=>
    <div>
        <a onclick="switchTab('@constants.View.VIEW_DOCUMENTS','1', jsRoutes.controllers.ComponentViewController.traderViewNegotiationFile('@id', '@negotiationFile.documentType'))">@Messages(negotiationFile.documentType)</a>
        @negotiationFile.documentType match{
            case constants.File.INVOICE=> {<td class="seenIcon"><img src="@routes.Assets.versioned("./images/icons/seenIcon.svg")" onclick="getForm(jsRoutes.controllers.NegotiationController.negotiationDocumentContent('@id','@negotiationFile.documentType'))")></td>}
            case constants.File.CONTRACT=>{
                    <td class="seenIcon"><img src="@routes.Assets.versioned("./images/icons/seenIcon.svg")" onclick="getForm(jsRoutes.controllers.NegotiationController.negotiationDocumentContent('@id','@negotiationFile.documentType'))")></td>
                    @if(traderID == negotiation.sellerTraderID && envelopeStatus.isEmpty){
                        @commonModalButton(constants.View.SEND_FOR_SIGNATURE, routes.javascript.DocusignController.embeddedSending,'parameters -> s"'${id}','${constants.File.CONTRACT}'")
                    }
                   @if(traderID == negotiation.buyerTraderID && envelopeStatus == Some(constants.Status.DocuSignEnvelopeStatus.SENT)){
                       @commonModalButton(constants.View.E_SIGN, routes.javascript.DocusignController.embeddedSigning,'parameters -> s"'${id}'")
                   }
            }
            case _=>{}
        }

    </div>
}

