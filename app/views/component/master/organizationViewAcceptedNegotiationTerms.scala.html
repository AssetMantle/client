@import controllers.actions.LoginState
@import views.html.base._
@import models.master.{Asset, Negotiation}
@import models.master.Trader
@import models.master.Organization
@import models.master.AssetProperty

@(traderList:Seq[Trader], counterPartyOrganization:Organization, negotiation: Negotiation, assetProperty: AssetProperty)(implicit requestHeader: RequestHeader, messagesProvider: MessagesProvider, loginState: LoginState)

<div id='@Seq(negotiation.id, "TermsView").mkString("")'>
    <div class="tradeTerms">
        <div class="traderCommodity">
            <span class="commodityImage"><img src="@routes.Assets.versioned("images/icons/" + asset.getOrElse(constants.Property.ASSET_TYPE.dataName,Some("")).getOrElse("") + ".svg")"></span><span class="tradeName">@Messages(asset.getOrElse(constants.Property.ASSET_TYPE.dataName,Some("")).getOrElse(""))</span>
        </div>
        <div class="cmuk-flex cmuk-flex-between">
            <div class="title">@Messages(constants.View.COUNTER_PARTY_DETAILS)</div>
        </div>
        <div class="sellerTerm">
            <div class="cmuk-flex">
                <span class="termIcon">@commonIcon("description")</span>
                @traderList.find(_.organizationID != counterPartyOrganization.id) match {
                    case Some(trader)=>{@commonTextInfo(constants.View.TRADER,trader.accountID)}
                    case None=>{}
                }
            </div>
        </div>

        @traderList.find(_.organizationID == counterPartyOrganization.id) match {
            case Some(trader)=>{
                <div class="sellerTerm">
                    <div class="cmuk-flex">
                        <span class="termIcon">@commonIcon("description")</span>
                        @commonTextInfo(constants.View.COUNTER_PARTY_TRADER, trader.accountID)
                    </div>
                </div>
                <div class="sellerTerm">
                    <div class="cmuk-flex">
                        <span class="termIcon">@commonIcon("description")</span>
                        @commonTextInfo(constants.View.COUNTER_PARTY_ORGANIZATION, counterPartyOrganization.name)
                    </div>
                </div>
            }
            case None=>{}
        }
        <div class="terms">
            <div class="cmuk-flex cmuk-flex-between">
                <div class="title">@Messages(constants.View.ASSET_DETAILS)</div>
            </div>

            <div class="sellerTerm">
                <div class="cmuk-flex">
                    <span class="termIcon">@commonIcon("description")</span>
                    @commonTextInfo(constants.View.ASSET_DESCRIPTION, negotiation.assetDescription)
                </div>
                <div>
                @if(negotiation.buyerAcceptedAssetDescription) {
                    <span class="cmuk-badge verified">@constants.View.ACCEPTED</span>
                } else {
                    <span class="cmuk-badge pending">@constants.View.PENDING</span>
                }
                </div>
            </div>
            <div class="sellerTerm">
                <div>
                <div class="cmuk-flex">
                    <span class="termIcon">@commonIcon("contractPrice")</span>
                    @commonTextInfo(constants.View.PRICE_PER_UNIT, Seq((negotiation.price/negotiation.quantity).toString, Messages(constants.View.USD), Messages(constants.View.PER), negotiation.quantityUnit).mkString(" "))
                </div>
                    <div class="cmuk-flex">
                        <span class="termIcon">@commonIcon("contractPrice")</span>
                        @commonTextInfo(constants.View.TOTAL_AMOUNT, Seq(negotiation.price.toRoundedOffString(), Messages(constants.View.USD)).mkString(" "))
                    </div>
                </div>
                <div>
                @if(negotiation.buyerAcceptedPrice) {
                    <span class="cmuk-badge verified">@constants.View.ACCEPTED</span>
                } else {
                    <span class="cmuk-badge pending">@constants.View.PENDING</span>
                }
                </div>
            </div>
            <div class="sellerTerm">
                <div class="cmuk-flex">
                    <span class="termIcon">@commonIcon("quantity")</span>
                    @commonTextInfo(constants.View.QUANTITY, Seq(negotiation.quantity.toString, negotiation.quantityUnit).mkString(" "))
                </div>
                <div>
                @if(negotiation.buyerAcceptedQuantity) {
                    <span class="cmuk-badge verified">@constants.View.ACCEPTED</span>
                } else {
                    <span class="cmuk-badge pending">@constants.View.PENDING</span>
                }
                </div>
            </div>
            <div class="cmuk-flex cmuk-flex-between">
                <div class="title">@Messages(constants.View.ASSET_OTHER_DETAILS)</div>
            </div>
            <div class="sellerTerm">
                <div>
                    <div class="cmuk-flex">
                        <span class="termIcon">@commonIcon("port")</span>
                        @commonTextInfo(constants.View.LOAD_PORT, negotiation.assetOtherDetails.shippingDetails.portOfLoading)
                    </div>
                    <div class="cmuk-flex">
                        <span class="termIcon">@commonIcon("port")</span>
                        @commonTextInfo(constants.View.DISCHARGE_PORT, negotiation.assetOtherDetails.shippingDetails.portOfDischarge)
                    </div>
                    <div class="cmuk-flex">
                        <span class="termIcon">@commonIcon("shipmentPeriod")</span>
                        @commonIntInfo(constants.View.SHIPMENT_PERIOD, negotiation.assetOtherDetails.shippingDetails.shippingPeriod)
                    </div>
                </div>
                <div>
                    @if(negotiation.buyerAcceptedAssetOtherDetails){
                        <span class="cmuk-badge verified">@constants.View.ACCEPTED</span>
                    } else{
                        <span class="cmuk-badge pending">@constants.View.PENDING</span>
                    }
                    </div>
            </div>
            <hr>

            <div class="cmuk-flex cmuk-flex-between">
                <div class="title">@Messages(constants.View.PAYMENT_TERMS)</div>
            </div>
            <div class="sellerTerm">
                <div>
                    <div class="cmuk-flex">
                        <span class="termIcon">@commonIcon("advancePayment")</span>
                        @commonDoubleInfo(constants.View.ADVANCE_PERCENTAGE, negotiation.paymentTerms.advancePercentage)
                    </div>
                    <div class="subTerms">
                     @negotiation.paymentTerms.credit match {
                            case Some(credit) => {
                                @Messages(constants.View.CREDIT_TERMS):
                                @credit.tentativeDate match {
                                    case Some(date) => {
                                        @commonDateInfo(constants.View.TENTATIVE_DATE, date)
                                    }
                                    case None => {
                                        @commonTextInfo(constants.View.TENURE, Seq(credit.tenure.getOrElse(0).toString, Messages(constants.View.DAYS)).mkString(" "))
                                        @commonTextInfo(constants.View.REFERENCE, credit.reference.getOrElse(""))
                                    }
                                }

                            }
                            case None => {}
                        }
                    </div>
                </div>
                <div>
                    @if(negotiation.buyerAcceptedPaymentTerms) {
                        <span class="cmuk-badge verified">@constants.View.ACCEPTED</span>
                    } else {
                        <span class="cmuk-badge pending">@constants.View.PENDING</span>
                    }
                </div>
            </div>

            <hr>

            <div class="cmuk-flex cmuk-flex-between">
                <div class="title"> @Messages(constants.View.DOCUMENT_LIST)</div>
            </div>
            <div class="sellerTerm">
                <div>
                    <p><span class="cmuk-text-bold">@Messages(constants.View.ASSET_DOCUMENTS):</span>
                    @negotiation.documentList.assetDocuments.map{assetDocument=>
                        <p>
                            <span class="termIcon">@commonIcon("document")</span>
                            @Messages(assetDocument)
                        </p>
                    }
                    <p><span class="cmuk-text-bold"> @Messages(constants.View.NEGOTIATION_DOCUMENTS):</span>
                    @negotiation.documentList.negotiationDocuments.map{negotiationDocument=>
                        <p>
                            <span class="termIcon">@commonIcon("document")</span>
                            @Messages(negotiationDocument)
                        </p>
                    }
                </div>
                <div>
                    @if(negotiation.buyerAcceptedDocumentList){
                        <span class="cmuk-badge verified">@constants.View.ACCEPTED</span>
                    } else{
                        <span class="cmuk-badge pending">@constants.View.PENDING</span>
                    }
                </div>
            </div>
        </div>
    </div>
</div>
