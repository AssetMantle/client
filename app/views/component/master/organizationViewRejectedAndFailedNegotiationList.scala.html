@import controllers.actions.LoginState
@import models.master.{Asset, Negotiation, Organization, Trader}
@import views.html.base._

@(rejectedReceivedNegotiationList: Seq[Negotiation], rejectedSentNegotiationList: Seq[Negotiation], failedNegotiationList: Seq[Negotiation], traderList: Seq[Trader], counterPartyTraderList: Seq[Trader], counterPartyOrganizationList: Seq[Organization], assetList: Seq[Asset])(implicit requestHeader: RequestHeader, messagesProvider: MessagesProvider, loginState: LoginState = null)

<div class="cmuk-text-left title">@Messages(constants.View.REJECTED_RECEIVED_NEGOTIATION_LIST)</div>
<div class="salesQuoteCard">
@rejectedReceivedNegotiationList.map { rejectedReceivedNegotiation =>
    @commonVerticalInfoBox() {
        <div class="salesQuoteCardLeft salesChild">
            <div class="salesQuoteCategory buy">
            </div>
            <div class="content">
            @assetList.find(_.id == rejectedReceivedNegotiation.assetID) match {
                case Some(asset) => {
                    <div class="assetIcon">
                        <span class="commodityImage"><img src="@routes.Assets.versioned("images/icons/" + asset.assetType + ".svg")"></span>
                    </div>
                    <div class="assetInitialData">
                        <p class="assetTitle">@Messages(asset.assetType)</p>
                        <p class="assetQuantity">@Seq(rejectedReceivedNegotiation.quantity.toString, rejectedReceivedNegotiation.quantityUnit).mkString(" ")</p>
                    </div>
                }
                case None => {}
            }
            </div>
        </div>
        <div class="salesQuoteCardMiddle salesChild">
            @assetList.find(_.id == rejectedReceivedNegotiation.assetID) match {
                case Some(asset) => {
                    <div class="assetInitialData">
                        <p class="assetPrice">@Seq((rejectedReceivedNegotiation.price/rejectedReceivedNegotiation.quantity).toString, Messages(constants.View.USD), Messages(constants.View.PER), rejectedReceivedNegotiation.quantityUnit).mkString(" ")</p>
                    </div>
                }
                case None => {}
            }
            @counterPartyTraderList.find(_.id == rejectedReceivedNegotiation.sellerTraderID) match {
                case Some(trader) => {
                    @counterPartyOrganizationList.find(_.id == trader.organizationID) match {
                        case Some(organization) => {
                            <p><span class="organizationName" cmuk-tooltip="@Messages(constants.View.ORGANIZATION)">@organization.name</span> </p>
                        }
                        case None => {}
                    }
                    <p><span cmuk-tooltip="@Messages(constants.View.BUYER)"> @trader.accountID</span>
                        <span class="lines">---</span>
                        }
                case None => {}
            }
            @traderList.find(_.id == rejectedReceivedNegotiation.buyerTraderID) match {
                case Some(trader) => {
                    <span cmuk-tooltip="@Messages(constants.View.BUYER)">@trader.accountID</span></p>
                }
                case None => {
                    <span>@rejectedReceivedNegotiation.buyerTraderID</span>
                    </p>
                }
            }
        </div>
        <div class="salesQuoteCardRight salesChild">
            <div class="cmuk-flex">
                <span class="arrowIcon">@commonIcon("navigationDownArrow")</span>
                <div class="cmuk-text-left">
                    @commonLargeTextBox(rejectedReceivedNegotiation.assetOtherDetails.shippingDetails.portOfLoading)
                    @commonLargeTextBox(rejectedReceivedNegotiation.assetOtherDetails.shippingDetails.portOfDischarge)
                </div>
            </div>
            <div class="cmuk-text-center">
            <p>@Messages(rejectedReceivedNegotiation.comment.getOrElse(""))</p>
            @commonModalButton(constants.View.VIEW_QUOTE, routes.javascript.ComponentViewController.organizationViewNegotiation, 'parameters -> s"'${rejectedReceivedNegotiation.id}'")
        </div>
        </div>
    }
    }
</div>

<div class="cmuk-text-left title">@Messages(constants.View.REJECTED_SENT_NEGOTIATION_LIST)</div>
<div class="salesQuoteCard">
@rejectedSentNegotiationList.map { rejectedSentNegotiation =>
    @commonVerticalInfoBox() {
        <div class="salesQuoteCardLeft salesChild">
            <div class="salesQuoteCategory sell">
            </div>
            <div class="content">
            @assetList.find(_.id == rejectedSentNegotiation.assetID) match {
                case Some(asset) => {
                    <div class="assetIcon">
                        <span class="commodityImage"><img src="@routes.Assets.versioned("images/icons/" + asset.assetType + ".svg")"></span>
                    </div>
                    <div class="assetInitialData">
                        <p class="assetTitle">@Messages(asset.assetType)</p>
                        <p class="assetQuantity">@Seq(rejectedSentNegotiation.quantity.toString, rejectedSentNegotiation.quantityUnit).mkString(" ")</p>
                    </div>
                }
                case None => {}
            }
            </div>
        </div>
        <div class="salesQuoteCardMiddle salesChild">
            @assetList.find(_.id == rejectedSentNegotiation.assetID) match {
                case Some(asset) => {
                    <div class="assetInitialData">
                        <p class="assetPrice">@Seq((rejectedSentNegotiation.price/rejectedSentNegotiation.quantity).toString, Messages(constants.View.USD), Messages(constants.View.PER), rejectedSentNegotiation.quantityUnit).mkString(" ")</p>
                    </div>
                }
                case None => {}
            }
            @counterPartyTraderList.find(_.id == rejectedSentNegotiation.buyerTraderID) match {
                case Some(trader) => {
                    @counterPartyOrganizationList.find(_.id == trader.organizationID) match {
                        case Some(organization) => {
                            <p><span class="organizationName" cmuk-tooltip="@Messages(constants.View.ORGANIZATION)">@organization.name</span> </p>
                        }
                        case None => {}
                    }
                    <p><span cmuk-tooltip="@Messages(constants.View.BUYER)"> @trader.accountID</span>
                        <span class="lines">---</span>
                        }
                case None => {}
            }
            @traderList.find(_.id == rejectedSentNegotiation.sellerTraderID) match {
                case Some(trader) => {
                    <span cmuk-tooltip="@Messages(constants.View.SELLER)">@trader.accountID</span></p>
                }
                case None => {
                    <span>@rejectedSentNegotiation.buyerTraderID</span>
                    </p>
                }
            }

        </div>
        <div class="salesQuoteCardRight salesChild">
            <div class="cmuk-flex">
                <span class="arrowIcon">@commonIcon("navigationDownArrow")</span>
                <div class="cmuk-text-left">
                    @commonLargeTextBox(rejectedSentNegotiation.assetOtherDetails.shippingDetails.portOfLoading)
                    @commonLargeTextBox(rejectedSentNegotiation.assetOtherDetails.shippingDetails.portOfDischarge)
                </div>
            </div>
            <div class="cmuk-text-center">
            <p>@Messages(rejectedSentNegotiation.comment.getOrElse(""))</p>
            @commonModalButton(constants.View.VIEW_QUOTE, routes.javascript.ComponentViewController.organizationViewNegotiation, 'parameters -> s"'${rejectedSentNegotiation.id}'")
        </div>
        </div>
    }
    }
</div>

<div class="cmuk-text-left title">@Messages(constants.View.FAILED_NEGOTIATION_LIST)</div>
<div class="salesQuoteCard">
    @failedNegotiationList.map { failedNegotiation =>
        @commonVerticalInfoBox() {
            <div class="salesQuoteCardLeft salesChild">
                <div class="content">
                @assetList.find(_.id == failedNegotiation.assetID) match {
                    case Some(asset) => {
                        <div class="assetIcon">
                            <span class="commodityImage"><img src="@routes.Assets.versioned("images/icons/" + asset.assetType + ".svg")"></span>
                        </div>
                        <div class="assetInitialData">
                            <p class="assetTitle">@Messages(asset.assetType)</p>
                            <p class="assetQuantity">@Seq(failedNegotiation.quantity.toString, failedNegotiation.quantityUnit).mkString(" ")</p>
                        </div>
                    }
                    case None => {}
                }
                </div>
            </div>
            <div class="salesQuoteCardMiddle salesChild">
                @assetList.find(_.id == failedNegotiation.assetID) match {
                    case Some(asset) => {
                        <div class="assetInitialData">
                            <p class="assetPrice">@Seq((failedNegotiation.price/failedNegotiation.quantity).toString, Messages(constants.View.USD), Messages(constants.View.PER), failedNegotiation.quantityUnit).mkString(" ")</p>
                        </div>
                    }
                    case None => {}
                }
                @counterPartyTraderList.find(_.id == failedNegotiation.buyerTraderID) match {
                    case Some(trader) => {
                        @counterPartyOrganizationList.find(_.id == trader.organizationID) match {
                            case Some(organization) => {
                                <p><span class="organizationName" cmuk-tooltip="@Messages(constants.View.ORGANIZATION)">@organization.name</span> </p>
                            }
                            case None => {}
                        }
                        <p><span cmuk-tooltip="@Messages(constants.View.BUYER)">@trader.accountID</span>
                            <span class="lines">---</span>
                            }
                    case None => {}
                }

                @traderList.find(_.id == failedNegotiation.sellerTraderID) match {
                    case Some(trader) => {
                        <span cmuk-tooltip="@Messages(constants.View.SELLER)">@trader.accountID</span></p>
                    }
                    case None => {
                        <span>@failedNegotiation.buyerTraderID</span>
                        </p>
                    }
                }
            </div>
            <div class="salesQuoteCardRight salesChild">
                <div class="cmuk-flex">
                    <span class="arrowIcon">@commonIcon("navigationDownArrow")</span>
                    <div class="cmuk-text-left">
                        @commonLargeTextBox(failedNegotiation.assetOtherDetails.shippingDetails.portOfLoading)
                        @commonLargeTextBox(failedNegotiation.assetOtherDetails.shippingDetails.portOfDischarge)
                    </div>
                </div>
                <div class="cmuk-text-center">
                <p>@Messages(failedNegotiation.status)</p>
                @commonModalButton(constants.View.VIEW_QUOTE, routes.javascript.ComponentViewController.organizationViewNegotiation, 'parameters -> s"'${failedNegotiation.id}'")
            </div>
            </div>
        }
    }
</div>