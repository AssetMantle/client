@import controllers.actions.LoginState
@import views.html.base._
@import models.master.Negotiation
@import models.master.Asset
@import models.master.Trader
@import models.master.Organization

@(receivedNegotiationRequestList: Seq[Negotiation], counterPartyTraderList: Seq[Trader], counterPartyOrganizationList: Seq[Organization], assetList: Map[String, Map[String,Option[String]]])(implicit requestHeader: RequestHeader, messagesProvider: MessagesProvider, loginState: LoginState = null)

 <div class="salesQuoteCard">
    @receivedNegotiationRequestList.map { receivedNegotiationRequest =>
        @commonVerticalInfoBox(){
            <div class="salesQuoteCardLeft salesChild">
                <div class="salesQuoteCategory buy">
                </div>
                <div class="content">
                @assetList.get(receivedNegotiationRequest.assetID) match {
                    case Some(asset) => {
                        <div class="assetIcon">
                            <span class="commodityImage"><img src="@routes.Assets.versioned("images/icons/" + asset.getOrElse(constants.Property.ASSET_TYPE.dataName,Some("")).getOrElse("") + ".svg")"></span>
                        </div>
                        <div class="assetInitialData">
                            <p class="assetTitle">@Messages(asset.getOrElse(constants.Property.ASSET_TYPE.dataName,Some("")).getOrElse(""))</p>
                            <p class="assetQuantity">@Seq(receivedNegotiationRequest.quantity.toRoundedOffString(), receivedNegotiationRequest.quantityUnit).mkString(" ")</p>
                        </div>
                    }
                    case None => {}
                }
                </div>
            </div>
            <div class="salesQuoteCardMiddle salesChild">
                @assetList.find(_._1 == receivedNegotiationRequest.assetID) match {
                    case Some(asset) => {
                        <div class="assetInitialData">
                            <p class="assetPrice">@Seq((receivedNegotiationRequest.price/receivedNegotiationRequest.quantity).toRoundedOffString(), Messages(constants.View.USD), Messages(constants.View.PER), receivedNegotiationRequest.quantityUnit).mkString(" ")</p>
                        </div>
                    }
                    case None => {}
                }

                @counterPartyTraderList.find(_.id == receivedNegotiationRequest.sellerTraderID) match {
                    case Some(trader) => {
                        @counterPartyOrganizationList.find(_.id == trader.organizationID) match {
                            case Some(organization) => {
                                <p><span class="organizationName" cmuk-tooltip="@Messages(constants.View.ORGANIZATION)">@organization.name</span></p>
                            }
                            case None => {}
                        }
                        <p><span cmuk-tooltip="@Messages(constants.View.TRADER)">@trader.accountID</span></p>
                    }
                    case None => {}
                }
            </div>
            <div class="salesQuoteCardRight salesChild">
                <div class="cmuk-flex">
                    <span class="arrowIcon">@commonIcon("navigationDownArrow")</span>
                    <div class="cmuk-text-left">
                    <p><span>@receivedNegotiationRequest.assetOtherDetails.shippingDetails.portOfDischarge</span></p>
                    </div>
                </div>
                <div class="cmuk-text-center">
                @commonModalButton(constants.View.VIEW_QUOTE, routes.javascript.ComponentViewController.traderViewNegotiation, 'parameters -> s"'${receivedNegotiationRequest.id}'")
                  <div>
                    @commonFormButton(constants.Form.ACCEPT_NEGOTIATION_REQUEST, 'parameters -> s"'${receivedNegotiationRequest.id}'", 'class -> "cmuk-button-success")
                    @commonFormButton(constants.Form.REJECT_NEGOTIATION_REQUEST, 'parameters -> s"'${receivedNegotiationRequest.id}'", 'class -> "cmuk-button-danger")
                  </div>
                </div>
            </div>
        }
    }
</div>