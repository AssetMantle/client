@import controllers.actions.LoginState
@import views.companion.master.NegotiationRequest
@import views.html.base._
@import models.master.Asset
@import models.master.Trader
@import models.master.Organization

@(negotiationRequestForm: Form[NegotiationRequest.Data] = NegotiationRequest.form, tradableAssetList: Seq[Asset], counterPartyTraderList: Seq[Trader], counterPartyOrganizationList: Seq[Organization])(implicit requestHeader: RequestHeader, messagesProvider: MessagesProvider, flash: Flash, loginState: LoginState = null)

@commonForm(constants.Form.NEGOTIATION_REQUEST, negotiationRequestForm) {
    <div class="cmuk-text-left panelHeader">@Messages(constants.View.SELECT_ASSET)</div>
    <div class="cmuk-panel cmuk-panel-scrollable">
        <ul class="cmuk-list">
        @tradableAssetList.map { asset =>
            <li cmuk-tooltip="@Messages(constants.View.NEGOTIATION_REQUEST_ASSET_DETAILS_TOOLTIP, asset.quantity, asset.quantityUnit, asset.assetType, asset.price, asset.otherDetails.shippingDetails.shippingPeriod, asset.otherDetails.shippingDetails.portOfDischarge, asset.otherDetails.shippingDetails.shippingPeriod)" onclick="fillAssetPegHashField('@asset.id')">
                @asset.id | @asset.description | @Messages(asset.status)</li>
        }
        </ul>
    </div>
    @commonFormButton(constants.Form.ISSUE_ASSET)
    @commonInputText(negotiationRequestForm, constants.FormField.ASSET_ID, 'id -> "negotiationRequestAssetID", 'readonly -> true)
    <div class="cmuk-text-left panelHeader">@Messages(constants.View.SELECT_COUNTER_PARTY)</div>
    <div class="cmuk-panel cmuk-panel-scrollable">
        <ul class="cmuk-list">
        @counterPartyTraderList.map { trader =>
                @counterPartyOrganizationList.find(_.id== trader.organizationID) match {
                    case Some(organization)=> {
                        <li onclick="fillCounterPartyField('@trader.id')">@trader.accountID | @constants.View.ORGANIZATION: @organization.name</li>
                        }
                    case None=>{}
            }
        }
        </ul>
    </div>
    @commonFormButton(constants.Form.TRADER_RELATION_REQUEST)
    @commonInputText(negotiationRequestForm, constants.FormField.COUNTER_PARTY, 'id -> "negotiationRequestCounterParty", 'readonly -> true)
}
<script src="@routes.Assets.versioned("javascripts/negotiationRequest.js")" type="text/javascript"></script>