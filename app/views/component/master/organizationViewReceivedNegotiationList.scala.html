@import controllers.actions.LoginState
@import views.html.base._
@import models.master.Negotiation
@import models.master.Asset
@import models.master.Trader

@(receivedNegotiationList: Seq[Negotiation], traders: Seq[Trader], counterPartyTraders: Seq[Trader])(implicit requestHeader: RequestHeader, messagesProvider: MessagesProvider, loginState: LoginState = null)

@receivedNegotiationList.map { receivedNegotiation =>
    @commonInfoBox() {
        @defining(traders.find(_.id == receivedNegotiation.buyerTraderID)) { organizationTrader: Option[Trader] =>
            @organizationTrader match {
                case Some(trader) => {
                    @commonTextInfo(constants.View.BUYER_TRADER_NAME, trader.name)
                }
                case None => {
                    @commonTextInfo(constants.View.BUYER_TRADER_ID, receivedNegotiation.buyerTraderID)
                }
            }
        }
        @defining(counterPartyTraders.find(_.id == receivedNegotiation.sellerTraderID)) { counterPartyTrader: Option[Trader] =>
            @counterPartyTrader match {
                case Some(trader) => {
                    @commonTextInfo(constants.View.SELLER_TRADER_NAME, trader.name)
                }
                case None => {
                    @commonTextInfo(constants.View.SELLER_TRADER_ID, receivedNegotiation.sellerTraderID)
                }
            }
        }
        @commonTextInfo(constants.View.ASSET_DESCRIPTION, receivedNegotiation.assetDescription)
        @commonIntInfo(constants.View.PRICE, receivedNegotiation.price)
        @commonTextInfo(constants.View.QUANTITY, Seq(receivedNegotiation.quantity.toString, receivedNegotiation.quantityUnit).mkString(" "))
    }
}
