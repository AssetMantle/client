@import controllers.actions.LoginState
@import views.html.base._
@import models.master.Asset
@import models.master.Negotiation
@import models.master.Trader
@import views.companion.master.ReviewNegotiationRequest

@(traderReviewNegotiationRequest: Form[ReviewNegotiationRequest.Data] = ReviewNegotiationRequest.form, asset: Asset, negotiation: Negotiation, counterPartyTrader: Trader)(implicit requestHeader: RequestHeader, messagesProvider: MessagesProvider, loginState: LoginState = null)
@commonForm(constants.Form.REVIEW_NEGOTIATION_REQUEST, traderReviewNegotiationRequest) {
    <div class="cmuk-text-left title">@Messages(constants.View.COUNTER_PARTY_DETAILS)</div>
    @commonTextInfo(constants.View.COUNTER_PARTY, counterPartyTrader.name)
    @commonTextInfo(constants.View.ACCOUNT_ID, counterPartyTrader.accountID)
    <div class="cmuk-text-left title">@Messages(constants.View.ASSET)</div>
    @commonTextInfo(constants.Form.ASSET_TYPE, asset.assetType)
    @commonTextInfo(constants.View.ASSET_DESCRIPTION, asset.description)
    @commonTextInfo(constants.Form.ASSET_QUANTITY, asset.quantityUnit)
    @commonTextInfo(constants.Form.QUANTITY_UNIT, asset.quantityUnit)
    @commonIntInfo(constants.Form.ASSET_PRICE, asset.price)
    @commonBooleanInfo(constants.Form.MODERATED, Option(asset.moderated))
    @commonIntInfo(constants.Form.SHIPPING_PERIOD, asset.otherDetails.shippingDetails.shippingPeriod)
    @commonTextInfo(constants.Form.PORT_OF_LOADING, asset.otherDetails.shippingDetails.portOfLoading)
    @commonTextInfo(constants.Form.PORT_OF_DISCHARGE, asset.otherDetails.shippingDetails.portOfDischarge)
    <div class="cmuk-text-left title">@Messages(constants.View.PAYMENT_TERMS)</div>
    @commonDoubleInfo(constants.View.ADVANCE_PERCENTAGE, negotiation.paymentTerms.advancePercentage)
    @negotiation.paymentTerms.credit match {
        case Some(creditTerms) => {
            @creditTerms.tentativeDate match {
                case Some(date) => {@commonDateInfo(constants.View.TENTATIVE_DATE, date)}
                case None => {@commonIntInfo(constants.View.TENURE, creditTerms.tenure.getOrElse(0))}
            }
            @commonTextInfo(constants.View.REFERENCE, creditTerms.reference)
        }
        case None => {}
    }
    @commonBooleanInfo(constants.View.CREDIT, Option(negotiation.paymentTerms.credit.isDefined))
    <div class="cmuk-text-left title">@Messages(constants.View.DOCUMENT_LIST)</div>
    @negotiation.documentList.assetDocuments.map { assetDocument =>
        @assetDocument
        <br>
    }
    @negotiation.documentList.negotiationDocuments.map { negotiationDocument =>
        @negotiationDocument
        <br>
    }

    @commonInputText(traderReviewNegotiationRequest, constants.FormField.ID, 'value -> negotiation.id, 'containerDivClass -> "hidden", 'readonly -> true)
    @commonModalButton(constants.View.BACK, constants.Form.NEGOTIATION_DOCUMENT_LIST.get, 'parameters -> s"'${negotiation.id}'")
}
