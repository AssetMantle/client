@import controllers.actions.LoginState
@import views.html.base._
@import models.masterTransaction.NegotiationFile
@import models.masterTransaction.AssetFile
@import models.master.Negotiation

@(negotiation: Negotiation, assetFiles: Seq[AssetFile], negotiationFiles: Seq[NegotiationFile])(implicit requestHeader: RequestHeader, messagesProvider: MessagesProvider, flash: Flash, loginState: LoginState = null)

<div>
    @Messages(constants.View.ASSET_DOCUMENTS):
    @negotiation.documentList.assetDocuments.map { assetDocuemntType =>
        <div id='@Seq("UPLOAD", "ASSET", assetDocuemntType).mkString("_")'>
        @commonModalButton(Seq("UPLOAD", assetDocuemntType).mkString("_"), routes.javascript.FileController.uploadAssetForm, 'parameters -> s"'${assetDocuemntType}','${negotiation.id}'")
        </div>
    }
    @assetFiles.filter(assetFile => negotiation.documentList.assetDocuments.contains(assetFile.documentType)).map { assetFile =>
        @component.master.commonDocumentViewer(assetFile) {
            @routes.FileController.tradingFile(negotiation.id, assetFile.fileName, assetFile.documentType)
        } {
            <a href="@routes.FileController.tradingFile(assetFile.id, assetFile.fileName, assetFile.documentType)">@Messages(assetFile.documentType)</a>
        } {
            @commonJavascriptButton(Seq(constants.Form.UPDATE, assetFile.documentType).mkString("_"),JavaScript(s"getForm(jsRoutes.controllers.OrderController.moderatedSellerExecuteOrderDocument('${assetFile.documentType}','${assetFile.id}'))"))
            @assetFile.documentType match {
                case constants.File.Asset.BILL_OF_LADING => {
                    @commonFormButton(constants.Form.ADD_BILL_OF_LADING, 'parameters -> s"'${negotiation.id}'")
                }
                case _ => {}
            }
            <script>hideElement('UPLOAD_ASSET_@assetFile.documentType')</script>
        }
    }


    @Messages(constants.View.NEGOTIATION_DOCUMENTS):

        <div id='@Seq("UPLOAD", "NEGOTIATION", constants.File.Negotiation.CONTRACT).mkString("_")'>
        @commonModalButton(Seq("UPLOAD", constants.File.Negotiation.CONTRACT).mkString("_"), routes.javascript.FileController.uploadNegotiationForm, 'parameters -> s"'${constants.File.Negotiation.CONTRACT}','${negotiation.id}'")
        </div>

    @negotiation.documentList.negotiationDocuments.filter(negotiationDocumentType => constants.File.NEGOTIATION_DOCUMENTS.contains(negotiationDocumentType)).map { negotiationDocumentType =>
        <div id='@Seq("UPLOAD_NEGOTIATION", negotiationDocumentType).mkString("_")'>
        @commonModalButton(Seq("UPLOAD", negotiationDocumentType).mkString("_"), routes.javascript.FileController.uploadNegotiationForm, 'parameters -> s"'${negotiationDocumentType}','${negotiation.id}'")
        </div>
    }

    @negotiationFiles.map { negotiationFile =>
        @component.master.commonDocumentViewer(negotiationFile) {
            @routes.FileController.tradingFile(negotiation.id, negotiationFile.fileName, negotiationFile.documentType)
        } {
            <a href="@routes.FileController.tradingFile(negotiation.id, negotiationFile.fileName, negotiationFile.documentType)">@Messages(negotiationFile.documentType)</a>
        } {
            @commonJavascriptButton(Seq(constants.Form.UPDATE, negotiationFile.documentType).mkString("_"),JavaScript(s"getForm(jsRoutes.controllers.FileController.updateNegotiationForm('${negotiationFile.documentType}','${negotiation.id}'))"))
            @negotiationFile.documentType match {
                case constants.File.Negotiation.INVOICE => {
                    @commonFormButton(constants.Form.ADD_INVOICE, 'parameters -> s"'${negotiation.id}'")
                }
                case constants.File.Negotiation.CONTRACT => {
                    @commonFormButton(constants.Form.ADD_CONTRACT, 'parameters -> s"'${negotiation.id}'")
                }
                case _ => {}
            }
            <script>hideElement('UPLOAD_NEGOTIATION_@negotiationFile.documentType')</script>
        }
    }

        <td><li><a href="@controllers.routes.ViewController.tradeRoom(negotiation.id)">@Messages(constants.Form.SUBMIT)</a></li></td>
</div>